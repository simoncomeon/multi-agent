#!/bin/bash

# Multi-Agent System Main Entry Point
# This is the primary script to start the multi-agent system

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
MULTI_AGENT_ROOT="$SCRIPT_DIR"
BIN_DIR="$MULTI_AGENT_ROOT/bin"

#!/bin/bash

# Multi-Agent AI System Launcher
# A sophisticated coordination system for specialized AI agents

echo "Universal Multi-Agent AI System"
echo "================================"
echo ""
echo "FRAMEWORK: Universal AI-powered development (React, Vue, Python, Node.js, Java, Go, C#, Rust)"
echo ""
echo "Available agent roles:"
echo " 1. coordinator - Universal project orchestration and workflow management"
echo " 2. coder - Framework-agnostic code generation and analysis"
echo " 3. code_reviewer - Cross-framework quality assurance and error detection"
echo " 4. code_rewriter - Automated code fixing with framework-specific best practices"
echo " 5. file_manager - Universal project creation across any technology stack"
echo " 6. git_manager - Framework-aware version control operations" 
echo " 7. researcher - Technology-agnostic information gathering and best practices"
echo ""

case "${1:-help}" in
 "start")
 shift
 exec "$BIN_DIR/launch.sh" "$@"
 ;;
 "demo")
 python3 "$MULTI_AGENT_ROOT/examples/demo_multi_agents.py"
 ;;
 "status")
 # Use the updated agent_status.py script which automatically finds the correct directory
 python3 "$MULTI_AGENT_ROOT/agent_status.py"
 ;;
 "workspace")
 cd "$MULTI_AGENT_ROOT/workspace"
 echo "Opening workspace: $(pwd)"
 exec $SHELL
 ;;
 "clean")
 echo " Cleaning Multi-Agent System..."
 
 # Kill any running agents
 pkill -f "multi_agent_terminal.py" 2>/dev/null && echo "Terminated running agents"
 
 # Clean communication files 
 if [ -d "$MULTI_AGENT_ROOT/.agent_comm" ]; then
 echo "[]" > "$MULTI_AGENT_ROOT/.agent_comm/agents.json"
 echo "[]" > "$MULTI_AGENT_ROOT/.agent_comm/tasks.json"
 echo "[]" > "$MULTI_AGENT_ROOT/.agent_comm/messages.json"
 echo " Communication files cleaned"
 fi
 
 # Also clean workspace comm files if they exist
 if [ -d "$MULTI_AGENT_ROOT/workspace/.agent_comm" ]; then
 echo "[]" > "$MULTI_AGENT_ROOT/workspace/.agent_comm/agents.json" 2>/dev/null
 echo "[]" > "$MULTI_AGENT_ROOT/workspace/.agent_comm/tasks.json" 2>/dev/null
 echo "[]" > "$MULTI_AGENT_ROOT/workspace/.agent_comm/messages.json" 2>/dev/null
 echo " Workspace communication files cleaned"
 fi
 
 echo "Multi-agent system cleaned and ready for fresh start!"
 ;;
 "cleanup"|"reset")
 echo " Deep Cleanup - Resetting Multi-Agent System..."
 "$MULTI_AGENT_ROOT/cleanup_agents_simple.py"
 ;;
 "help"|*)
 echo "Universal Multi-Agent AI System Help"
 echo "====================================="
 echo ""
 echo "LAUNCH: Quick Start Options:"
 echo " python3 smart_launcher.py ai-development  # Recommended: full universal team"
 echo " python3 smart_launcher.py --help          # Show all options and connection guide"
 echo ""
 echo "INFO: Individual Agent Launch:"
 echo " ./multi-agent start coordinator main # Start coordinator"
 echo " ./multi-agent start coder dev # Start coder (new terminal)"
 echo " ./multi-agent start code_reviewer reviewer # Start code reviewer"
 echo " ./multi-agent start code_rewriter fixer # Start code rewriter"
 echo " ./multi-agent start file_manager files # Start file manager"
 echo ""
 echo " Examples:"
 echo " ./multi-agent demo # See system demo"
 echo " ./multi-agent status # Check active agents"
 echo " ./multi-agent workspace # Enter workspace"
 echo " ./multi-agent clean # Quick cleanup"
 echo " ./multi-agent cleanup # Deep cleanup (thorough)"
 echo ""
 echo ""
 echo "STATUS: System Monitoring:"
 echo " python3 agent_status.py               # Check system status"
 echo " python3 agent_status.py --live 5      # Live monitoring"
 echo ""
 echo "INFO: Directory Structure:"
 echo " multi-agent/"
 echo " ├── multi-agent # Main entry script" 
 echo " ├── bin/ # Executables"
 echo " │ ├── launch.sh # Agent launcher"
 echo " │ └── multi_agent_terminal.py"
 echo " ├── workspace/ # Working directory"
 echo " │ └── .agent_comm/ # Inter-agent communication"
 echo " ├── examples/ # Demo scripts"
 echo " └── docs/ # Documentation"
 ;;
esac